---
- name: Create ocp clusters folders
  file:
    path: "~/{{ var_demofolder_name }}/{{ item.name }}"
    state: directory
  loop: "{{ var_cluster_info }}"

- name: Get {{ var_ocpinstall_filename }} installer file
  get_url:
    url: "{{ var_ocpinstall_url }}{{ var_ocpinstall_filename }}"
    dest: "~/{{ var_demofolder_name }}/"

- name: Extract ocp installer
  unarchive:
    src: "~/{{ var_demofolder_name }}/{{ var_ocpinstall_filename }}"
    dest: "~/{{ var_demofolder_name }}/"

- name: Copy {{ var_ocpinstall_filename_extract }} to clusters folders
  copy:
    src: "~/{{ var_demofolder_name }}/{{ var_ocpinstall_filename_extract }}"
    dest: "~/{{ var_demofolder_name }}/{{ item.name }}"
    mode: u+x,g+x,o+x
  loop: "{{ var_cluster_info }}"

- name: Copy configuration template to clusters folders
  template:
    src: "{{ var_installconfig_path }}"
    dest: "~/{{ var_demofolder_name }}/{{ item.name }}/install-config.yaml"
  loop: "{{ var_cluster_info }}"

- name: Copy configuration state to clusters folders
  template:
    src: "{{ var_installstate_path }}"
    dest: "~/{{ var_demofolder_name }}/{{ item.name }}/.openshift_install_state.json"
  loop: "{{ var_cluster_info }}"

- name: Get {{ var_occlient_filename }} file
  get_url:
    url: "{{ var_ocpinstall_url }}{{ var_occlient_filename }}"
    dest: "~/{{ var_demofolder_name }}/"

- name: Extract oc client
  unarchive:
    src: "~/{{ var_demofolder_name }}/{{ var_occlient_filename }}"
    dest: "~/bin/"

- name: Get {{ var_kubefedctl_filename }} file
  get_url:
    url: "{{ var_kubefedctl_url }}{{ var_kubefedctl_filename }}"
    dest: "~/{{ var_demofolder_name }}/"

- name: Extract kubefedctl client
  unarchive:
    src: "~/{{ var_demofolder_name }}/{{ var_kubefedctl_filename }}"
    dest: "~/bin/"
